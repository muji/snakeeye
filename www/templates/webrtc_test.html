<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>MediaMTX WebRTC cam1</title>
</head>
<body>
  <h2>MediaMTX Stream: cam1</h2>
  <video id="videoElement" autoplay playsinline controls width="640" height="360"></video>

  <script>
    const streamUrl = "http://192.168.100.51:8889/cam1/whep";

    const pc = new RTCPeerConnection({
      iceServers: [{ urls: ["stun:stun.l.google.com:19302"] }]
    });

    pc.addTransceiver("video", { direction: "recvonly" });

    pc.ontrack = (event) => {
      document.getElementById("videoElement").srcObject = event.streams[0];
    };

    pc.createOffer().then(offer => {
      return pc.setLocalDescription(offer);
    }).then(() => {
      return fetch(streamUrl, {
        method: "POST",
        headers: { "Content-Type": "application/sdp" },
        body: pc.localDescription.sdp
      });
    }).then(response => {
      return response.text();
    }).then(answerSdp => {
      const answer = new RTCSessionDescription({
        type: "answer",
        sdp: answerSdp
      });
      return pc.setRemoteDescription(answer);
    }).catch(error => {
      console.error("WebRTC setup failed:", error);
    });
  </script>
</body>
</html>
